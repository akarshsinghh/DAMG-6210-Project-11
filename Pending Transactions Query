
-----PENDING TRANSACTIONS----
SELECT 
*
FROM
(SELECT transactions.debit_account ,CUSTOMER.FIRST_NAME AS SFN, CUSTOMER.LAST_NAME AS SLN,  TRANSACTIONS.STATUS,TRANSACTIONS.tansaction_id
FROM CUSTOMER
INNER JOIN ACCOUNT ON CUSTOMER.CUSTOMER_ID= ACCOUNT.CUSTOMER_ID
INNER JOIN TRANSACTIONS ON TRANSACTIONS.Debit_Account= Account.AccountNumber
WHERE TRANSACTIONS.STATUS ='Pending') t1 
 INNER JOIN
(SELECT transactions.CREDIT_account ,CUSTOMER.FIRST_NAME AS RFN, CUSTOMER.LAST_NAME AS RLN,  TRANSACTIONS.tansaction_id
FROM CUSTOMER
INNER JOIN ACCOUNT ON CUSTOMER.CUSTOMER_ID= ACCOUNT.CUSTOMER_ID
INNER JOIN TRANSACTIONS ON TRANSACTIONS.credit_Account= Account.AccountNumber
WHERE TRANSACTIONS.STATUS ='Pending') t2
ON t1.tansaction_id = t2.tansaction_id;

------NEW CUSTOMER ADDED WITH ACCOUNT DETAILS---
SELECT CUSTOMER.CUSTOMER_ID, CUSTOMER.FIRST_NAME , CUSTOMER.LAST_NAME, ACCOUNT.ACCOUNTNUMBER,ACCOUNT_STATUS.STATUS,ACCOUNT.BRANCHIFSC  FROM CUSTOMER
INNER JOIN Account ON CUSTOMER.CUSTOMER_ID= ACCOUNT.CUSTOMER_ID
INNER JOIN ACCOUNT_STATUS ON ACCOUNT.ACCOUNTNUMBER = ACCOUNT_STATUS.ACCOUNT_NUMBER
WHERE CUSTOMER.CUSTOMER_ID= (SELECT MAX(CUSTOMER_ID) FROM CUSTOMER);
